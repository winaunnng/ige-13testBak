<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
       <record id="group_account_admin" model="res.groups">
                <field name="name">Admin User</field>
                 <field name="implied_ids" eval="[(4, ref('base.group_user'))]"/>
                <field name="category_id" ref="base.module_category_accounting_accounting"/>
       </record>
        <record id="group_account_admin_manager" model="res.groups">
                <field name="name">Admin Manager</field>
                 <field name="implied_ids" eval="[(4, ref('group_account_admin'))]"/>
                <field name="category_id" ref="base.module_category_accounting_accounting"/>
       </record>

        <record id="account.group_account_invoice" model="res.groups">
                <field name="implied_ids" eval="[(4, ref('group_account_admin_manager'))]"/>
                <field name="category_id" ref="base.module_category_accounting_accounting"/>
       </record>

       <record id="account_move_rule_admin_user" model="ir.rule">
            <field name="name">account.move.admin.user</field>
            <field name="model_id" ref="account.model_account_move"/>
            <field name="domain_force">[('create_uid','=',user.id),('type', 'in', ('in_invoice', 'in_refund', 'in_receipt','entry'))]</field>
            <field name="groups" eval="[(4, ref('sme_payment_approval.group_account_admin'))]"/>
       </record>

       <record id="account_move_rule_admin_manager" model="ir.rule">
            <field name="name">account.move.admin.manager</field>
            <field name="model_id" ref="account.model_account_move"/>
            <field name="domain_force">['|',('invoice_line_ids.analytic_account_id','=',False),('invoice_line_ids.analytic_account_id','in',[ a.id for a in user.analytic_account_ids ])]</field>
            <field name="groups" eval="[(4, ref('sme_payment_approval.group_account_admin_manager'))]"/>
       </record>

       <record id="account_payment_rule_invoice_user" model="ir.rule">
            <field name="name">account.payment.invoice.user</field>
            <field name="model_id" ref="account.model_account_payment"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('account.group_account_invoice'))]"/>
            <field name="perm_create" eval="1"/>
            <field name="perm_write" eval="1"/>
            <field name="perm_unlink" eval="1"/>
            <field name="perm_read" eval="1"/>
        </record>

       <record id="account_payment_rule_admin_user" model="ir.rule">
            <field name="name">account.payment.admin.user</field>
            <field name="model_id" ref="account.model_account_payment"/>
            <field name="domain_force">[('create_uid','=',user.id)]</field>
            <field name="groups" eval="[(4, ref('sme_payment_approval.group_account_admin'))]"/>
       </record>

       <record id="account_payment_rule_restrict_analytic_account" model="ir.rule">
            <field name="name">account.payment.restrict.analytic.user</field>
            <field name="model_id" ref="account.model_account_payment"/>
            <field name="groups" eval="[(4, ref('group_account_admin_manager'))]"/>
            <field name="domain_force">[('x_studio_field_mlgj4','in', [ a.id for a in user.analytic_account_ids ])]</field>
        </record>
        <record id="purchase.purchase_user_account_move_line_rule" model="ir.rule">
            <field name="domain_force">[('move_id.type', 'in', ('in_invoice', 'in_refund', 'in_receipt','entry'))]</field>
        </record>
    </data>
    <data noupdate="1">
          <delete model="ir.rule" id="purchase.purchase_user_account_move_rule"/>
   </data>
</odoo>